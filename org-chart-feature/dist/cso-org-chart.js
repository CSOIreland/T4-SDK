const e="cso-org-chart",t="cso-org-chart-container";function i(e){var t,i;return(null===(i=null===(t=function(e){const t=new DOMParser;e=e.replace(/ \/>/g,">").replace(/(<(area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr).*?>)/g,"$1</$2>");const i=t.parseFromString("<xml>"+e+"</xml>","text/xml"),n=t.parseFromString("","text/html");for(const e of Array.from(i.documentElement.children))n.body.appendChild(e);for(const e of Array.from(n.querySelectorAll("area,base,br,col,command,embed,hr,img,input,keygen,link,meta,param,source,track,wbr")))e.outerHTML="<"+e.outerHTML.slice(1).split("<")[0];return n}(e))||void 0===t?void 0:t.body)||void 0===i?void 0:i.childNodes)||null}function n(e){return t=>e.getAttribute(`data-${t}`)}class r{constructor(e){this._name="OrgChart",Promise.prototype.finally=function(e){let t=this.constructor;return this.then((i=>t.resolve(e()).then((()=>i))),(i=>t.resolve(e()).then((()=>{throw i}))))};let t=this,i=Object.assign({nodeTitle:"name",nodeId:"id",toggleSiblingsResp:!1,depth:999,chartClass:"",exportButton:!1,exportFilename:"OrgChart",parentNodeSymbol:"fa-users",draggable:!1,direction:"t2b",pan:!1,zoom:!1},e),n=i.data,r=document.createElement("div"),s=document.querySelector(i.chartContainer);if(this.options=i,delete this.options.data,this.chart=r,this.chartContainer=s,r.dataset.options=JSON.stringify(i),r.setAttribute("class","orgchart"+(""!==i.chartClass?" "+i.chartClass:"")+("t2b"!==i.direction?" "+i.direction:"")),"object"==typeof n)this.buildHierarchy(r,i.ajaxURL?n:this._attachRel(n,"00"),0);else if("string"==typeof n&&n.startsWith("#"))this.buildHierarchy(r,this._buildJsonDS(document.querySelector(n).children[0]),0);else{let e=document.createElement("i");e.setAttribute("class","fa fa-circle-o-notch fa-spin spinner"),r.appendChild(e),this._getJSON(n).then((function(e){t.buildHierarchy(r,i.ajaxURL?e:t._attachRel(e,"00"),0)})).catch((function(e){console.error("failed to fetch datasource for orgchart",e)})).finally((function(){let e=r.querySelector(".spinner");e.parentNode.removeChild(e)}))}if(r.addEventListener("click",this._clickChart.bind(this)),i.exportButton&&!s.querySelector(".oc-export-btn")){let e=document.createElement("button"),t=document.createElement("a");e.setAttribute("class","oc-export-btn"+(""!==i.chartClass?" "+i.chartClass:"")),e.innerHTML="Export",e.addEventListener("click",this._clickExportButton.bind(this)),t.setAttribute("class","oc-download-btn"+(""!==i.chartClass?" "+i.chartClass:"")),t.setAttribute("download",i.exportFilename+".png"),s.appendChild(e),s.appendChild(t)}i.pan&&(s.style.overflow="hidden",r.addEventListener("mousedown",this._onPanStart.bind(this)),r.addEventListener("touchstart",this._onPanStart.bind(this)),document.body.addEventListener("mouseup",this._onPanEnd.bind(this)),document.body.addEventListener("touchend",this._onPanEnd.bind(this))),i.zoom&&(s.addEventListener("wheel",this._onWheeling.bind(this)),s.addEventListener("touchstart",this._onTouchStart.bind(this)),document.body.addEventListener("touchmove",this._onTouchMove.bind(this)),document.body.addEventListener("touchend",this._onTouchEnd.bind(this))),s.appendChild(r)}get name(){return this._name}_closest(e,t){return e&&(t(e)&&e!==this.chart?e:this._closest(e.parentNode,t))}_siblings(e,t){return Array.from(e.parentNode.children).filter((i=>i!==e&&(!t||e.matches(t))))}_prevAll(e,t){let i=[],n=e.previousElementSibling;for(;n;)t&&!n.matches(t)||i.push(n),n=n.previousElementSibling;return i}_nextAll(e,t){let i=[],n=e.nextElementSibling;for(;n;)t&&!n.matches(t)||i.push(n),n=n.nextElementSibling;return i}_isVisible(e){return null!==e.offsetParent}_addClass(e,t){e.forEach((e=>{t.indexOf(" ")>0?t.split(" ").forEach((t=>e.classList.add(t))):e.classList.add(t)}))}_removeClass(e,t){e.forEach((e=>{t.indexOf(" ")>0?t.split(" ").forEach((t=>e.classList.remove(t))):e.classList.remove(t)}))}_css(e,t,i){e.forEach((e=>{e.style[t]=i}))}_removeAttr(e,t){e.forEach((e=>{e.removeAttribute(t)}))}_one(e,t,i,n){let r=function(s){try{i.call(n,s)}finally{e.removeEventListener(t,r)}};e.addEventListener(t,r)}_getDescElements(e,t){let i=[];return e.forEach((e=>i.push(...e.querySelectorAll(t)))),i}_getJSON(e){return new Promise((function(t,i){let n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=function(){4===this.readyState&&(200===this.status?t(JSON.parse(this.response)):i(new Error(this.statusText)))},n.responseType="json",n.setRequestHeader("Content-Type","application/json"),n.send()}))}_buildJsonDS(e){let t={name:e.firstChild.textContent.trim(),relationship:("LI"===e.parentNode.parentNode.nodeName?"1":"0")+(e.parentNode.children.length>1?1:0)+(e.children.length?1:0)};return e.id&&(t.id=e.id),e.querySelector("ul")&&Array.from(e.querySelector("ul").children).forEach((e=>{t.children||(t.children=[]),t.children.push(this._buildJsonDS(e))})),t}_attachRel(e,t){if(e.relationship=t+(e.children&&e.children.length>0?1:0),e.children)for(let t of e.children)this._attachRel(t,"1"+(e.children.length>1?1:0));return e}_repaint(e){e&&(e.style.offsetWidth=e.offsetWidth)}_isInAction(e){return e.querySelector(":scope > .edge").className.indexOf("fa-")>-1}_getNodeState(e,t){let i,n={exist:!1,visible:!1};return"parent"===t?(i=this._closest(e,(e=>e.classList&&e.classList.contains("nodes"))),i&&(n.exist=!0),n.exist&&this._isVisible(i.parentNode.children[0])&&(n.visible=!0)):"children"===t?(i=this._closest(e,(e=>"TR"===e.nodeName)).nextElementSibling,i&&(n.exist=!0),n.exist&&this._isVisible(i)&&(n.visible=!0)):"siblings"===t&&(i=this._siblings(this._closest(e,(e=>"TABLE"===e.nodeName)).parentNode),i.length&&(n.exist=!0),n.exist&&i.some((e=>this._isVisible(e)))&&(n.visible=!0)),n}getRelatedNodes(e,t){return"parent"===t?this._closest(e,(e=>e.classList.contains("nodes"))).parentNode.children[0].querySelector(".node"):"children"===t?Array.from(this._closest(e,(e=>"TABLE"===e.nodeName)).lastChild.children).map((e=>e.querySelector(".node"))):"siblings"===t?this._siblings(this._closest(e,(e=>"TABLE"===e.nodeName)).parentNode).map((e=>e.querySelector(".node"))):[]}_switchHorizontalArrow(e){let t=this.options,i=e.querySelector(".leftEdge"),n=e.querySelector(".rightEdge"),r=this._closest(e,(e=>"TABLE"===e.nodeName)).parentNode;if(t.toggleSiblingsResp&&(void 0===t.ajaxURL||this._closest(e,(e=>e.classList.contains(".nodes"))).dataset.siblingsLoaded)){let e=r.previousElementSibling,t=r.nextElementSibling;e&&(e.classList.contains("hidden")?(i.classList.add("fa-chevron-left"),i.classList.remove("fa-chevron-right")):(i.classList.add("fa-chevron-right"),i.classList.remove("fa-chevron-left"))),t&&(t.classList.contains("hidden")?(n.classList.add("fa-chevron-right"),n.classList.remove("fa-chevron-left")):(n.classList.add("fa-chevron-left"),n.classList.remove("fa-chevron-right")))}else{let e=this._siblings(r),t=!!e.length&&!e.some((e=>e.classList.contains("hidden")));i.classList.toggle("fa-chevron-right",t),i.classList.toggle("fa-chevron-left",!t),n.classList.toggle("fa-chevron-left",t),n.classList.toggle("fa-chevron-right",!t)}}_hoverNode(e){let t=e.target,i=!1,n=t.querySelector(":scope > .topEdge"),r=t.querySelector(":scope > .bottomEdge"),s=t.querySelector(":scope > .leftEdge");"mouseenter"===e.type?(n&&(i=this._getNodeState(t,"parent").visible,n.classList.toggle("fa-chevron-up",!i),n.classList.toggle("fa-chevron-down",i)),r&&(i=this._getNodeState(t,"children").visible,r.classList.toggle("fa-chevron-down",!i),r.classList.toggle("fa-chevron-up",i)),s&&this._switchHorizontalArrow(t)):Array.from(t.querySelectorAll(":scope > .edge")).forEach((e=>{e.classList.remove("fa-chevron-up","fa-chevron-down","fa-chevron-right","fa-chevron-left")}))}_clickNode(e){let t=e.currentTarget,i=this.chart.querySelector(".focused");i&&i.classList.remove("focused"),t.classList.add("focused")}_buildParentNode(e,t,i){let n=this,r=document.createElement("table");t.relationship=t.relationship||"001",this._createNode(t,0).then((function(e){let t=n.chart;e.classList.remove("slide-up"),e.classList.add("slide-down");let s=document.createElement("tr"),o=document.createElement("tr"),a=document.createElement("tr"),l=document.createElement("tr");s.setAttribute("class","hidden"),s.innerHTML='<td colspan="2"></td>',r.appendChild(s),o.setAttribute("class","lines hidden"),o.innerHTML='<td colspan="2"><div class="downLine"></div></td>',r.appendChild(o),a.setAttribute("class","lines hidden"),a.innerHTML='<td class="rightLine">&nbsp;</td><td class="leftLine">&nbsp;</td>',r.appendChild(a),l.setAttribute("class","nodes"),l.innerHTML='<td colspan="2"></td>',r.appendChild(l),r.querySelector("td").appendChild(e),t.insertBefore(r,t.children[0]),r.children[3].children[0].appendChild(t.lastChild),i()})).catch((function(e){console.error("Failed to create parent node",e)}))}_switchVerticalArrow(e){e.classList.toggle("fa-chevron-up"),e.classList.toggle("fa-chevron-down")}showParent(e){let t=this._prevAll(this._closest(e,(e=>e.classList.contains("nodes"))));this._removeClass(t,"hidden"),this._addClass(Array(t[0].children).slice(1,-1),"hidden");let i=t[2].querySelector(".node");this._one(i,"transitionend",(function(){i.classList.remove("slide"),this._isInAction(e)&&this._switchVerticalArrow(e.querySelector(":scope > .topEdge"))}),this),this._repaint(i),i.classList.add("slide"),i.classList.remove("slide-down")}showSiblings(e,t){let i=[],n=this._closest(e,(e=>"TABLE"===e.nodeName)).parentNode;i=t?"left"===t?this._prevAll(n):this._nextAll(n):this._siblings(n),this._removeClass(i,"hidden");let r=this._prevAll(this._closest(e,(e=>e.classList.contains("nodes"))));if(n=Array.from(r[0].querySelectorAll(":scope > .hidden")),t?this._removeClass(n.slice(0,2*i.length),"hidden"):this._removeClass(n,"hidden"),!this._getNodeState(e,"parent").visible){this._removeClass(r,"hidden");let e=r[2].querySelector(".node");this._one(e,"transitionend",(function(e){e.target.classList.remove("slide")}),this),this._repaint(e),e.classList.add("slide"),e.classList.remove("slide-down")}i.forEach((e=>{Array.from(e.querySelectorAll(".node")).forEach((e=>{this._isVisible(e)&&(e.classList.add("slide"),e.classList.remove("slide-left","slide-right"))}))})),this._one(i[0].querySelector(".slide"),"transitionend",(function(){i.forEach((e=>{this._removeClass(Array.from(e.querySelectorAll(".slide")),"slide")})),this._isInAction(e)&&(this._switchHorizontalArrow(e),e.querySelector(".topEdge").classList.remove("fa-chevron-up"),e.querySelector(".topEdge").classList.add("fa-chevron-down"))}),this)}hideSiblings(e,t){let i=this._closest(e,(e=>"TABLE"===e.nodeName)).parentNode;if(this._siblings(i).forEach((e=>{e.querySelector(".spinner")&&(this.chart.dataset.inAjax=!1)})),!t||t&&"left"===t){this._prevAll(i).forEach((e=>{Array.from(e.querySelectorAll(".node")).forEach((e=>{this._isVisible(e)&&e.classList.add("slide","slide-right")}))}))}if(!t||t&&"left"!==t){this._nextAll(i).forEach((e=>{Array.from(e.querySelectorAll(".node")).forEach((e=>{this._isVisible(e)&&e.classList.add("slide","slide-left")}))}))}let n=[];this._siblings(i).forEach((e=>{Array.prototype.push.apply(n,Array.from(e.querySelectorAll(".slide")))}));let r=[];for(let e of n){let t=this._closest(e,(function(e){return e.classList.contains("nodes")})).previousElementSibling;r.push(t),r.push(t.previousElementSibling)}r=[...new Set(r)],r.forEach((function(e){e.style.visibility="hidden"})),this._one(n[0],"transitionend",(function(s){r.forEach((function(e){e.removeAttribute("style")}));let o=[];o=t?"left"===t?this._prevAll(i,":not(.hidden)"):this._nextAll(i,":not(.hidden)"):this._siblings(i);let a=Array.from(this._closest(i,(function(e){return e.classList.contains("nodes")})).previousElementSibling.querySelectorAll(":scope > :not(.hidden)")).slice(1,t?2*o.length+1:-1);this._addClass(a,"hidden"),this._removeClass(n,"slide"),o.forEach((e=>{Array.from(e.querySelectorAll(".node")).slice(1).forEach((e=>{this._isVisible(e)&&(e.classList.remove("slide-left","slide-right"),e.classList.add("slide-up"))}))})),o.forEach((e=>{this._addClass(Array.from(e.querySelectorAll(".lines")),"hidden"),this._addClass(Array.from(e.querySelectorAll(".nodes")),"hidden"),this._addClass(Array.from(e.querySelectorAll(".verticalNodes")),"hidden")})),this._addClass(o,"hidden"),this._isInAction(e)&&this._switchHorizontalArrow(e)}),this)}hideParent(e){let t=Array.from(this._closest(e,(function(e){return e.classList.contains("nodes")})).parentNode.children).slice(0,3);t[0].querySelector(".spinner")&&(this.chart.dataset.inAjax=!1),this._getNodeState(e,"siblings").visible&&this.hideSiblings(e);let i=t.slice(1);this._css(i,"visibility","hidden");let n=t[0].querySelector(".node"),r=this._getNodeState(n,"parent").visible;n&&this._isVisible(n)&&(n.classList.add("slide","slide-down"),this._one(n,"transitionend",(function(){n.classList.remove("slide"),this._removeAttr(i,"style"),this._addClass(t,"hidden")}),this)),n&&r&&this.hideParent(n)}addParent(e,t){let i=this;this._buildParentNode(e,t,(function(){if(!e.querySelector(":scope > .topEdge")){let t=document.createElement("i");t.setAttribute("class","edge verticalEdge topEdge fa"),e.appendChild(t)}i.showParent(e)}))}_startLoading(e,t){let i=this.options,n=this.chart;if(void 0!==n.dataset.inAjax&&"true"===n.dataset.inAjax)return!1;e.classList.add("hidden");let r=document.createElement("i");r.setAttribute("class","fa fa-circle-o-notch fa-spin spinner"),t.appendChild(r),this._addClass(Array.from(t.querySelectorAll(":scope > *:not(.spinner)")),"hazy"),n.dataset.inAjax=!0;let s=this.chartContainer.querySelector(".oc-export-btn"+(""!==i.chartClass?"."+i.chartClass:""));return s&&(s.disabled=!0),!0}_endLoading(e,t){let i=this.options;e.classList.remove("hidden"),t.querySelector(":scope > .spinner").remove(),this._removeClass(Array.from(t.querySelectorAll(":scope > .hazy")),"hazy"),this.chart.dataset.inAjax=!1;let n=this.chartContainer.querySelector(".oc-export-btn"+(""!==i.chartClass?"."+i.chartClass:""));n&&(n.disabled=!1)}_clickTopEdge(e){e.stopPropagation();let t=this,i=e.target,n=i.parentNode,r=this._getNodeState(n,"parent"),s=this.options;if(r.exist){let e=this._closest(n,(function(e){return e.classList.contains("nodes")})).parentNode.firstChild.querySelector(".node");if(e.classList.contains("slide"))return;r.visible?(this.hideParent(n),this._one(e,"transitionend",(function(){this._isInAction(n)&&(this._switchVerticalArrow(i),this._switchHorizontalArrow(n))}),this)):this.showParent(n)}else{let e=i.parentNode.id;this._startLoading(i,n)&&this._getJSON("function"==typeof s.ajaxURL.parent?s.ajaxURL.parent(n.dataset.source):s.ajaxURL.parent+e).then((function(e){"true"===t.chart.dataset.inAjax&&Object.keys(e).length&&t.addParent(n,e)})).catch((function(e){console.error("Failed to get parent node data.",e)})).finally((function(){t._endLoading(i,n)}))}}hideChildren(e){let t=this,i=this._nextAll(e.parentNode.parentNode),n=i[i.length-1],r=[];n.querySelector(".spinner")&&(this.chart.dataset.inAjax=!1);let s=Array.from(n.querySelectorAll(".node")).filter((e=>t._isVisible(e))),o=n.classList.contains("verticalNodes");o||(s.forEach((e=>{Array.prototype.push.apply(r,t._prevAll(t._closest(e,(e=>e.classList.contains("nodes"))),".lines"))})),r=[...new Set(r)],this._css(r,"visibility","hidden")),this._one(s[0],"transitionend",(function(a){this._removeClass(s,"slide"),o?t._addClass(i,"hidden"):(r.forEach((e=>{e.removeAttribute("style"),e.classList.add("hidden"),e.parentNode.lastChild.classList.add("hidden")})),this._addClass(Array.from(n.querySelectorAll(".verticalNodes")),"hidden")),this._isInAction(e)&&this._switchVerticalArrow(e.querySelector(".bottomEdge"))}),this),this._addClass(s,"slide slide-up")}showChildren(e){let t=this,i=this._nextAll(e.parentNode.parentNode),n=[];this._removeClass(i,"hidden"),i.some((e=>e.classList.contains("verticalNodes")))?i.forEach((e=>{Array.prototype.push.apply(n,Array.from(e.querySelectorAll(".node")).filter((e=>t._isVisible(e))))})):Array.from(i[2].children).forEach((e=>{Array.prototype.push.apply(n,Array.from(e.querySelector("tr").querySelectorAll(".node")).filter((e=>t._isVisible(e))))})),this._repaint(n[0]),this._one(n[0],"transitionend",(t=>{this._removeClass(n,"slide"),this._isInAction(e)&&this._switchVerticalArrow(e.querySelector(".bottomEdge"))}),this),this._addClass(n,"slide"),this._removeClass(n,"slide-up")}_buildChildNode(e,t,i){let n=t.children||t.siblings;e.querySelector("td").setAttribute("colSpan",2*n.length),this.buildHierarchy(e,{children:n},0,i)}addChildren(e,t){let i=this,n=this.options,r=0;this.chart.dataset.inEdit="addChildren",this._buildChildNode.call(this,this._closest(e,(e=>"TABLE"===e.nodeName)),t,(function(){if(++r===t.children.length){if(!e.querySelector(".bottomEdge")){let t=document.createElement("i");t.setAttribute("class","edge verticalEdge bottomEdge fa"),e.appendChild(t)}if(!e.querySelector(".symbol")){let t=document.createElement("i");t.setAttribute("class","fa "+n.parentNodeSymbol+" symbol"),e.querySelector(":scope > .title").appendChild(t)}i.showChildren(e),i.chart.dataset.inEdit=""}}))}_clickBottomEdge(e){e.stopPropagation();let t=this,i=this.options,n=e.target,r=n.parentNode,s=this._getNodeState(r,"children");if(s.exist){let e=this._closest(r,(function(e){return"TR"===e.nodeName})).parentNode.lastChild;if(Array.from(e.querySelectorAll(".node")).some((e=>this._isVisible(e)&&e.classList.contains("slide"))))return;s.visible?this.hideChildren(r):this.showChildren(r)}else{let e=n.parentNode.id;this._startLoading(n,r)&&this._getJSON("function"==typeof i.ajaxURL.children?i.ajaxURL.children(r.dataset.source):i.ajaxURL.children+e).then((function(e){"true"===t.chart.dataset.inAjax&&e.children.length&&t.addChildren(r,e)})).catch((function(e){console.error("Failed to get children nodes data",e)})).finally((function(){t._endLoading(n,r)}))}}_complementLine(e,t,i){let n=e.parentNode.parentNode.children;n[0].children[0].setAttribute("colspan",2*t),n[1].children[0].setAttribute("colspan",2*t);for(let e=0;e<i;e++){let e=document.createElement("td"),t=document.createElement("td");e.setAttribute("class","rightLine topLine"),e.innerHTML="&nbsp;",n[2].insertBefore(e,n[2].children[1]),t.setAttribute("class","leftLine topLine"),t.innerHTML="&nbsp;",n[2].insertBefore(t,n[2].children[1])}}_buildSiblingNode(e,t,i){let n=this,r=t.siblings?t.siblings.length:t.children.length,s="TD"===e.parentNode.nodeName?this._closest(e,(e=>"TR"===e.nodeName)).children.length:1,o=s+r,a=o>1?Math.floor(o/2-1):0;if("TD"===e.parentNode.nodeName){let l=this._prevAll(e.parentNode.parentNode);l[0].remove(),l[1].remove();let d=0;n._buildChildNode.call(n,n._closest(e.parentNode,(e=>"TABLE"===e.nodeName)),t,(()=>{if(++d===r){let t=Array.from(n._closest(e.parentNode,(e=>"TABLE"===e.nodeName)).lastChild.children);if(s>1){let i=e.parentNode.parentNode;Array.from(i.children).forEach((e=>{t[0].parentNode.insertBefore(e,t[0])})),i.remove(),n._complementLine(t[0],o,s),n._addClass(t,"hidden"),t.forEach((e=>{n._addClass(e.querySelectorAll(".node"),"slide-left")}))}else{let i=e.parentNode.parentNode;t[a].parentNode.insertBefore(e.parentNode,t[a+1]),i.remove(),n._complementLine(t[a],o,1),n._addClass(t,"hidden"),n._addClass(n._getDescElements(t.slice(0,a+1),".node"),"slide-right"),n._addClass(n._getDescElements(t.slice(a+1),".node"),"slide-left")}i()}}))}else{let r=0;n.buildHierarchy.call(n,n.chart,t,0,(()=>{if(++r===o){let t=e.nextElementSibling.children[3].children[a],r=document.createElement("td");r.setAttribute("colspan",2),r.appendChild(e),t.parentNode.insertBefore(r,t.nextElementSibling),n._complementLine(t,o,1);let s=n._closest(e,(e=>e.classList&&e.classList.contains("nodes"))).parentNode.children[0];s.classList.add("hidden"),n._addClass(Array.from(s.querySelectorAll(".node")),"slide-down");let l=this._siblings(e.parentNode);n._addClass(l,"hidden"),n._addClass(n._getDescElements(l.slice(0,a),".node"),"slide-right"),n._addClass(n._getDescElements(l.slice(a),".node"),"slide-left"),i()}}))}}addSiblings(e,t){let i=this;this.chart.dataset.inEdit="addSiblings",this._buildSiblingNode.call(this,this._closest(e,(e=>"TABLE"===e.nodeName)),t,(()=>{if(i._closest(e,(e=>e.classList&&e.classList.contains("nodes"))).dataset.siblingsLoaded=!0,!e.querySelector(".leftEdge")){let t=document.createElement("i"),i=document.createElement("i");t.setAttribute("class","edge horizontalEdge rightEdge fa"),e.appendChild(t),i.setAttribute("class","edge horizontalEdge leftEdge fa"),e.appendChild(i)}i.showSiblings(e),i.chart.dataset.inEdit=""}))}removeNodes(e){let t=this._closest(e,(e=>"TABLE"===e.nodeName)).parentNode,i=this._siblings(t.parentNode);"TD"===t.nodeName?this._getNodeState(e,"siblings").exist?(i[2].querySelector(".topLine").nextElementSibling.remove(),i[2].querySelector(".topLine").remove(),i[0].children[0].setAttribute("colspan",i[2].children.length),i[1].children[0].setAttribute("colspan",i[2].children.length),t.remove()):(i[0].children[0].removeAttribute("colspan"),i[0].querySelector(".bottomEdge").remove(),this._siblings(i[0]).forEach((e=>e.remove()))):Array.from(t.parentNode.children).forEach((e=>e.remove()))}_clickHorizontalEdge(e){e.stopPropagation();let t=this,i=this.options,n=e.target,r=n.parentNode,s=this._getNodeState(r,"siblings");if(s.exist){let e=this._closest(r,(function(e){return"TABLE"===e.nodeName})).parentNode;if(this._siblings(e).some((e=>{let t=e.querySelector(".node");return this._isVisible(t)&&t.classList.contains("slide")})))return;if(i.toggleSiblingsResp){let e=this._closest(r,(e=>"TABLE"===e.nodeName)).parentNode.previousElementSibling,t=this._closest(r,(e=>"TABLE"===e.nodeName)).parentNode.nextElementSibling;n.classList.contains("leftEdge")?e.classList.contains("hidden")?this.showSiblings(r,"left"):this.hideSiblings(r,"left"):t.classList.contains("hidden")?this.showSiblings(r,"right"):this.hideSiblings(r,"right")}else s.visible?this.hideSiblings(r):this.showSiblings(r)}else{let e=n.parentNode.id,s=this._getNodeState(r,"parent").exist?"function"==typeof i.ajaxURL.siblings?i.ajaxURL.siblings(JSON.parse(r.dataset.source)):i.ajaxURL.siblings+e:"function"==typeof i.ajaxURL.families?i.ajaxURL.families(JSON.parse(r.dataset.source)):i.ajaxURL.families+e;this._startLoading(n,r)&&this._getJSON(s).then((function(e){"true"===t.chart.dataset.inAjax&&(e.siblings||e.children)&&t.addSiblings(r,e)})).catch((function(e){console.error("Failed to get sibling nodes data",e)})).finally((function(){t._endLoading(n,r)}))}}_clickToggleButton(e){let t=this,i=e.target,n=i.parentNode.nextElementSibling,r=Array.from(n.querySelectorAll(".node")),s=Array.from(n.children).map((e=>e.querySelector(".node")));s.some((e=>e.classList.contains("slide")))||(i.classList.toggle("fa-plus-square"),i.classList.toggle("fa-minus-square"),r[0].classList.contains("slide-up")?(n.classList.remove("hidden"),this._repaint(s[0]),this._addClass(s,"slide"),this._removeClass(s,"slide-up"),this._one(s[0],"transitionend",(()=>{t._removeClass(s,"slide")}))):(this._addClass(r,"slide slide-up"),this._one(r[0],"transitionend",(()=>{t._removeClass(r,"slide"),r.forEach((e=>{t._closest(e,(function(e){return"UL"===e.nodeName})).classList.add("hidden")}))})),r.forEach((e=>{let i=Array.from(e.querySelectorAll(".toggleBtn"));t._removeClass(i,"fa-minus-square"),t._addClass(i,"fa-plus-square")}))))}_dispatchClickEvent(e){let t=e.target.classList;t.contains("topEdge")?this._clickTopEdge(e):t.contains("rightEdge")||t.contains("leftEdge")?this._clickHorizontalEdge(e):t.contains("bottomEdge")?this._clickBottomEdge(e):t.contains("toggleBtn")?this._clickToggleButton(e):this._clickNode(e)}_onDragStart(e){let t=e.target,i=this.options,n=/firefox/.test(window.navigator.userAgent.toLowerCase());if(n&&e.dataTransfer.setData("text/html","hack for firefox"),this.chart.style.transform){let r,s;document.querySelector(".ghost-node")?(r=this.chart.querySelector(":scope > .ghost-node"),s=r.children[0]):(r=document.createElementNS("http://www.w3.org/2000/svg","svg"),r.classList.add("ghost-node"),s=document.createElementNS("http://www.w3.org/2000/svg","rect"),r.appendChild(s),this.chart.appendChild(r));let o=this.chart.style.transform.split(","),a=Math.abs(window.parseFloat("t2b"===i.direction||"b2t"===i.direction?o[0].slice(o[0].indexOf("(")+1):o[1]));r.setAttribute("width",t.offsetWidth),r.setAttribute("height",t.offsetHeight),s.setAttribute("x",5*a),s.setAttribute("y",5*a),s.setAttribute("width",120*a),s.setAttribute("height",40*a),s.setAttribute("rx",4*a),s.setAttribute("ry",4*a),s.setAttribute("stroke-width",1*a);let l=e.offsetX*a,d=e.offsetY*a;if("l2r"===i.direction?(l=e.offsetY*a,d=e.offsetX*a):"r2l"===i.direction?(l=t.offsetWidth-e.offsetY*a,d=e.offsetX*a):"b2t"===i.direction&&(l=t.offsetWidth-e.offsetX*a,d=t.offsetHeight-e.offsetY*a),n){let t=document.createElement("img");t.src="data:image/svg+xml;utf8,"+(new XMLSerializer).serializeToString(r),e.dataTransfer.setDragImage(t,l,d),s.setAttribute("fill","rgb(255, 255, 255)"),s.setAttribute("stroke","rgb(191, 0, 0)")}else e.dataTransfer.setDragImage(r,l,d)}let r=e.target,s=this._closest(r,(e=>e.classList&&e.classList.contains("nodes"))).parentNode.children[0].querySelector(".node"),o=Array.from(this._closest(r,(e=>"TABLE"===e.nodeName)).querySelectorAll(".node"));this.dragged=r,Array.from(this.chart.querySelectorAll(".node")).forEach((function(e){o.includes(e)||(i.dropCriteria?i.dropCriteria(r,s,e)&&e.classList.add("allowedDrop"):e.classList.add("allowedDrop"))}))}_onDragOver(e){e.preventDefault(),e.currentTarget.classList.contains("allowedDrop")||(e.dataTransfer.dropEffect="none")}_onDragEnd(e){Array.from(this.chart.querySelectorAll(".allowedDrop")).forEach((function(e){e.classList.remove("allowedDrop")}))}_onDrop(e){let t=e.currentTarget,i=this.chart,n=this.dragged,r=this._closest(n,(function(e){return e.classList&&e.classList.contains("nodes")})).parentNode.children[0].children[0];if(this._removeClass(Array.from(i.querySelectorAll(".allowedDrop")),"allowedDrop"),t.parentNode.parentNode.nextElementSibling){let e=window.parseInt(t.parentNode.colSpan)+2;if(t.parentNode.setAttribute("colspan",e),t.parentNode.parentNode.nextElementSibling.children[0].setAttribute("colspan",e),!n.querySelector(".horizontalEdge")){let e=document.createElement("i"),t=document.createElement("i");e.setAttribute("class","edge horizontalEdge rightEdge fa"),n.appendChild(e),t.setAttribute("class","edge horizontalEdge leftEdge fa"),n.appendChild(t)}let i=t.parentNode.parentNode.nextElementSibling.nextElementSibling,r=document.createElement("td"),s=document.createElement("td");r.setAttribute("class","leftLine topLine"),r.innerHTML="&nbsp;",i.insertBefore(r,i.children[1]),s.setAttribute("class","rightLine topLine"),s.innerHTML="&nbsp;",i.insertBefore(s,i.children[2]),i.nextElementSibling.appendChild(this._closest(n,(function(e){return"TABLE"===e.nodeName})).parentNode);let o=this._siblings(this._closest(n,(function(e){return"TABLE"===e.nodeName})).parentNode).map((e=>e.querySelector(".node")));if(1===o.length){let e=document.createElement("i"),t=document.createElement("i");e.setAttribute("class","edge horizontalEdge rightEdge fa"),o[0].appendChild(e),t.setAttribute("class","edge horizontalEdge leftEdge fa"),o[0].appendChild(t)}}else{let e=document.createElement("i");e.setAttribute("class","edge verticalEdge bottomEdge fa"),t.appendChild(e),t.parentNode.setAttribute("colspan",2);let i=this._closest(t,(function(e){return"TABLE"===e.nodeName})),r=document.createElement("tr"),s=document.createElement("tr"),o=document.createElement("tr");r.setAttribute("class","lines"),r.innerHTML='<td colspan="2"><div class="downLine"></div></td>',i.appendChild(r),s.setAttribute("class","lines"),s.innerHTML='<td class="rightLine">&nbsp;</td><td class="leftLine">&nbsp;</td>',i.appendChild(s),o.setAttribute("class","nodes"),i.appendChild(o),Array.from(n.querySelectorAll(".horizontalEdge")).forEach((e=>{n.removeChild(e)}));let a=this._closest(n,(e=>"TABLE"===e.nodeName)).parentNode;o.appendChild(a)}let s=window.parseInt(r.colSpan);if(s>2){r.setAttribute("colspan",s-2),r.parentNode.nextElementSibling.children[0].setAttribute("colspan",s-2);let e=r.parentNode.nextElementSibling.nextElementSibling;e.children[1].remove(),e.children[1].remove();let t=Array.from(r.parentNode.parentNode.children[3].children).map((function(e){return e.querySelector(".node")}));1===t.length&&(t[0].querySelector(".leftEdge").remove(),t[0].querySelector(".rightEdge").remove())}else r.removeAttribute("colspan"),r.querySelector(".node").removeChild(r.querySelector(".bottomEdge")),Array.from(r.parentNode.parentNode.children).slice(1).forEach((e=>e.remove()));let o=new CustomEvent("nodedropped.orgchart",{detail:{draggedNode:n,dragZone:r.children[0],dropZone:t}});i.dispatchEvent(o)}_createNode(e,t){let i=this,n=this.options;return new Promise((function(r,s){if(e.children)for(let t of e.children)t.parentId=e.id;let o=document.createElement("div");delete e.children,o.dataset.source=JSON.stringify(e),e[n.nodeId]&&(o.id=e[n.nodeId]);let a,l=i.chart.dataset.inEdit;a=l?"addChildren"===l?" slide-up":"":t>=n.depth?" slide-up":"",o.setAttribute("class","node "+(e.className||"")+a),n.draggable&&o.setAttribute("draggable",!0),e.parentId&&o.setAttribute("data-parent",e.parentId),o.innerHTML=`\n        <div class="title">${e[n.nodeTitle]}</div>\n        ${n.nodeContent?`<div class="content">${e[n.nodeContent]}</div>`:""}\n      `;let d=e.relationship||"";if(n.verticalDepth&&t+2>n.verticalDepth){if(t+1>=n.verticalDepth&&Number(d.substr(2,1))){let e=document.createElement("i"),i=t+1>=n.depth?"plus":"minus";e.setAttribute("class","toggleBtn fa fa-"+i+"-square"),o.appendChild(e)}}else{if(Number(d.substr(0,1))){let e=document.createElement("i");e.setAttribute("class","edge verticalEdge topEdge fa"),o.appendChild(e)}if(Number(d.substr(1,1))){let e=document.createElement("i"),t=document.createElement("i");e.setAttribute("class","edge horizontalEdge rightEdge fa"),o.appendChild(e),t.setAttribute("class","edge horizontalEdge leftEdge fa"),o.appendChild(t)}if(Number(d.substr(2,1))){let e=document.createElement("i"),t=document.createElement("i"),i=o.querySelector(":scope > .title");e.setAttribute("class","edge verticalEdge bottomEdge fa"),o.appendChild(e),t.setAttribute("class","fa "+n.parentNodeSymbol+" symbol"),i.insertBefore(t,i.children[0])}}o.addEventListener("mouseenter",i._hoverNode.bind(i)),o.addEventListener("mouseleave",i._hoverNode.bind(i)),o.addEventListener("click",i._dispatchClickEvent.bind(i)),n.draggable&&(o.addEventListener("dragstart",i._onDragStart.bind(i)),o.addEventListener("dragover",i._onDragOver.bind(i)),o.addEventListener("dragend",i._onDragEnd.bind(i)),o.addEventListener("drop",i._onDrop.bind(i))),n.createNode&&n.createNode(o,e),r(o)}))}buildHierarchy(e,t,i,n){let r,s=this,o=this.options,a=t.children,l=o.verticalDepth&&i+1>=o.verticalDepth;if(Object.keys(t).length>1&&(r=l?e:document.createElement("table"),l||e.appendChild(r),this._createNode(t,i).then((function(e){if(l)r.insertBefore(e,r.firstChild);else{let t=document.createElement("tr");t.innerHTML=`\n            <td ${a?`colspan="${2*a.length}"`:""}>\n            </td>\n          `,t.children[0].appendChild(e),r.insertBefore(t,r.children[0]?r.children[0]:null)}n&&n()})).catch((function(e){console.error("Failed to creat node",e)}))),a){1===Object.keys(t).length&&(r=e);let l,d=o.verticalDepth&&i+2>=o.verticalDepth,c=s.chart.dataset.inEdit;if(l=c?"addSiblings"===c?"":" hidden":i+1>=o.depth?" hidden":"",!d){let e=document.createElement("tr");e.setAttribute("class","lines"+l),e.innerHTML=`\n          <td colspan="${2*a.length}">\n            <div class="downLine"></div>\n          </td>\n        `,r.appendChild(e)}let h,u=document.createElement("tr");if(u.setAttribute("class","lines"+l),u.innerHTML=`\n        <td class="rightLine">&nbsp;</td>\n        ${a.slice(1).map((()=>'\n          <td class="leftLine topLine">&nbsp;</td>\n          <td class="rightLine topLine">&nbsp;</td>\n          ')).join("")}\n        <td class="leftLine">&nbsp;</td>\n      `,d)if(h=document.createElement("ul"),l&&h.classList.add(l.trim()),i+2===o.verticalDepth){let e=document.createElement("tr");e.setAttribute("class","verticalNodes"+l),e.innerHTML="<td></td>",e.firstChild.appendChild(h),r.appendChild(e)}else r.appendChild(h);else h=document.createElement("tr"),h.setAttribute("class","nodes"+l),r.appendChild(u),r.appendChild(h);a.forEach((e=>{let t;d?t=document.createElement("li"):(t=document.createElement("td"),t.setAttribute("colspan",2)),h.appendChild(t),s.buildHierarchy(t,e,i+1,n)}))}}_clickChart(e){!this._closest(e.target,(function(e){return e.classList&&e.classList.contains("node")}))&&this.chart.querySelector(".node.focused")&&this.chart.querySelector(".node.focused").classList.remove("focused")}_clickExportButton(){let e=this.options,t=this.chartContainer,i=t.querySelector(":scope > .mask"),n=t.querySelector(".orgchart:not(.hidden)"),r="l2r"===e.direction||"r2l"===e.direction;i?i.classList.remove("hidden"):(i=document.createElement("div"),i.setAttribute("class","mask"),i.innerHTML='<i class="fa fa-circle-o-notch fa-spin spinner"></i>',t.appendChild(i)),t.classList.add("canvasContainer"),window.html2canvas(n,{width:r?n.clientHeight:n.clientWidth,height:r?n.clientWidth:n.clientHeight,onclone:function(e){let t=e.querySelector(".canvasContainer");t.style.overflow="visible",t.querySelector(".orgchart:not(.hidden)").transform=""}}).then((e=>{let i=t.querySelector(".oc-download-btn");t.querySelector(".mask").classList.add("hidden"),i.setAttribute("href",e.toDataURL()),i.click()})).catch((e=>{console.error("Failed to export the curent orgchart!",e)})).finally((()=>{t.classList.remove("canvasContainer")}))}_loopChart(e){let t={id:e.querySelector(".node").id};return e.children[3]&&Array.from(e.children[3].children).forEach((e=>{t.children||(t.children=[]),t.children.push(this._loopChart(e.firstChild))})),t}getHierarchy(){return this.chart.querySelector(".node").id?this._loopChart(this.chart.querySelector("table")):"Error: Nodes of orghcart to be exported must have id attribute!"}_onPanStart(e){let t=e.currentTarget;if(this._closest(e.target,(e=>e.classList&&e.classList.contains("node")))||e.touches&&e.touches.length>1)return void(t.dataset.panning=!1);t.style.cursor="move",t.dataset.panning=!0;let i=0,n=0,r=window.getComputedStyle(t).transform;if("none"!==r){let e=r.split(",");r.includes("3d")?(i=Number.parseInt(e[12],10),n=Number.parseInt(e[13],10)):(i=Number.parseInt(e[4],10),n=Number.parseInt(e[5],10))}let s=0,o=0;if(e.targetTouches){if(1===e.targetTouches.length)s=e.targetTouches[0].pageX-i,o=e.targetTouches[0].pageY-n;else if(e.targetTouches.length>1)return}else s=e.pageX-i,o=e.pageY-n;t.dataset.panStart=JSON.stringify({startX:s,startY:o}),t.addEventListener("mousemove",this._onPanning.bind(this)),t.addEventListener("touchmove",this._onPanning.bind(this))}_onPanning(e){let t=e.currentTarget;if("false"===t.dataset.panning)return;let i=0,n=0,r=JSON.parse(t.dataset.panStart),s=r.startX,o=r.startY;if(e.targetTouches){if(1===e.targetTouches.length)i=e.targetTouches[0].pageX-s,n=e.targetTouches[0].pageY-o;else if(e.targetTouches.length>1)return}else i=e.pageX-s,n=e.pageY-o;let a=window.getComputedStyle(t).transform;if("none"===a)a.includes("3d")?t.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+i+", "+n+", 0, 1)":t.style.transform="matrix(1, 0, 0, 1, "+i+", "+n+")";else{let e=a.split(",");a.includes("3d")?(e[12]=i,e[13]=n):(e[4]=i,e[5]=n+")"),t.style.transform=e.join(",")}}_onPanEnd(e){let t=this.chart;"true"===t.dataset.panning&&(t.dataset.panning=!1,t.style.cursor="default",document.body.removeEventListener("mousemove",this._onPanning),document.body.removeEventListener("touchmove",this._onPanning))}_setChartScale(e,t){let i=window.getComputedStyle(e).transform;if("none"===i)e.style.transform="scale("+t+","+t+")";else{let n=i.split(",");i.includes("3d")?e.style.transform=i+" scale3d("+t+","+t+", 1)":(n[0]="matrix("+t,n[3]=t,e.style.transform=i+" scale("+t+","+t+")")}e.dataset.scale=t}_onWheeling(e){e.preventDefault();let t=e.deltaY>0?.8:1.2;this._setChartScale(this.chart,t)}_getPinchDist(e){return Math.sqrt((e.touches[0].clientX-e.touches[1].clientX)*(e.touches[0].clientX-e.touches[1].clientX)+(e.touches[0].clientY-e.touches[1].clientY)*(e.touches[0].clientY-e.touches[1].clientY))}_onTouchStart(e){let t=this.chart;if(e.touches&&2===e.touches.length){let i=this._getPinchDist(e);t.dataset.pinching=!0,t.dataset.pinchDistStart=i}}_onTouchMove(e){let t=this.chart;if(t.dataset.pinching){let i=this._getPinchDist(e);t.dataset.pinchDistEnd=i}}_onTouchEnd(e){let t=this.chart;if(t.dataset.pinching){t.dataset.pinching=!1;let e=t.dataset.pinchDistEnd-t.dataset.pinchDistStart;e>0?this._setChartScale(t,1):e<0&&this._setChartScale(t,-1)}}}class s extends r{constructor(...e){super(...e)}_createNode(e,t){return super._createNode(e,t)}_buildJsonDS(e){return super._buildJsonDS(e)}showChildren(e){const t=this,i=this._nextAll(e.parentNode.parentNode),n=[];this._removeClass(i,"hidden"),i.some((e=>e.classList.contains("verticalNodes")))?(Array.from(i).forEach((e=>{var t,i;null===(i=null===(t=e.querySelector("ul.hidden"))||void 0===t?void 0:t.classList)||void 0===i||i.remove("hidden")})),i.forEach((e=>{Array.prototype.push.apply(n,Array.from(e.querySelectorAll(".node")).filter((e=>t._isVisible(e))))}))):Array.from(i[2].children).forEach((e=>{Array.prototype.push.apply(n,Array.from(e.querySelector("tr").querySelectorAll(".node")).filter((e=>t._isVisible(e))))})),this._repaint(n[0]),this._one(n[0],"transitionend",(()=>{this._removeClass(n,"slide"),this._isInAction(e)&&this._switchVerticalArrow(e.querySelector(".bottomEdge"))}),this),this._addClass(n,"slide"),this._removeClass(n,"slide-up")}}var o="top",a="bottom",l="right",d="left",c="auto",h=[o,a,l,d],u="start",p="end",f="clippingParents",m="viewport",g="popper",v="reference",b=h.reduce((function(e,t){return e.concat([t+"-"+u,t+"-"+p])}),[]),y=[].concat(h,[c]).reduce((function(e,t){return e.concat([t,t+"-"+u,t+"-"+p])}),[]),_=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function E(e){return e?(e.nodeName||"").toLowerCase():null}function L(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function A(e){return e instanceof L(e).Element||e instanceof Element}function S(e){return e instanceof L(e).HTMLElement||e instanceof HTMLElement}function w(e){return"undefined"!=typeof ShadowRoot&&(e instanceof L(e).ShadowRoot||e instanceof ShadowRoot)}var x={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var i=t.styles[e]||{},n=t.attributes[e]||{},r=t.elements[e];S(r)&&E(r)&&(Object.assign(r.style,i),Object.keys(n).forEach((function(e){var t=n[e];!1===t?r.removeAttribute(e):r.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],r=t.attributes[e]||{},s=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce((function(e,t){return e[t]="",e}),{});S(n)&&E(n)&&(Object.assign(n.style,s),Object.keys(r).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]};function C(e){return e.split("-")[0]}var N=Math.max,q=Math.min,T=Math.round;function O(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function D(){return!/^((?!chrome|android).)*safari/i.test(O())}function B(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var n=e.getBoundingClientRect(),r=1,s=1;t&&S(e)&&(r=e.offsetWidth>0&&T(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&T(n.height)/e.offsetHeight||1);var o=(A(e)?L(e):window).visualViewport,a=!D()&&i,l=(n.left+(a&&o?o.offsetLeft:0))/r,d=(n.top+(a&&o?o.offsetTop:0))/s,c=n.width/r,h=n.height/s;return{width:c,height:h,top:d,right:l+c,bottom:d+h,left:l,x:l,y:d}}function j(e){var t=B(e),i=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:n}}function k(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&w(i)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function I(e){return L(e).getComputedStyle(e)}function H(e){return["table","td","th"].indexOf(E(e))>=0}function P(e){return((A(e)?e.ownerDocument:e.document)||window.document).documentElement}function R(e){return"html"===E(e)?e:e.assignedSlot||e.parentNode||(w(e)?e.host:null)||P(e)}function M(e){return S(e)&&"fixed"!==I(e).position?e.offsetParent:null}function z(e){for(var t=L(e),i=M(e);i&&H(i)&&"static"===I(i).position;)i=M(i);return i&&("html"===E(i)||"body"===E(i)&&"static"===I(i).position)?t:i||function(e){var t=/firefox/i.test(O());if(/Trident/i.test(O())&&S(e)&&"fixed"===I(e).position)return null;var i=R(e);for(w(i)&&(i=i.host);S(i)&&["html","body"].indexOf(E(i))<0;){var n=I(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(e)||t}function V(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function W(e,t,i){return N(e,q(t,i))}function F(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function U(e,t){return t.reduce((function(t,i){return t[i]=e,t}),{})}var J={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,n=e.name,r=e.options,s=i.elements.arrow,c=i.modifiersData.popperOffsets,u=C(i.placement),p=V(u),f=[d,l].indexOf(u)>=0?"height":"width";if(s&&c){var m=function(e,t){return F("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:U(e,h))}(r.padding,i),g=j(s),v="y"===p?o:d,b="y"===p?a:l,y=i.rects.reference[f]+i.rects.reference[p]-c[p]-i.rects.popper[f],_=c[p]-i.rects.reference[p],E=z(s),L=E?"y"===p?E.clientHeight||0:E.clientWidth||0:0,A=y/2-_/2,S=m[v],w=L-g[f]-m[b],x=L/2-g[f]/2+A,N=W(S,x,w),q=p;i.modifiersData[n]=((t={})[q]=N,t.centerOffset=N-x,t)}},effect:function(e){var t=e.state,i=e.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&k(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function X(e){return e.split("-")[1]}var Y={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Z(e){var t,i=e.popper,n=e.popperRect,r=e.placement,s=e.variation,c=e.offsets,h=e.position,u=e.gpuAcceleration,f=e.adaptive,m=e.roundOffsets,g=e.isFixed,v=c.x,b=void 0===v?0:v,y=c.y,_=void 0===y?0:y,E="function"==typeof m?m({x:b,y:_}):{x:b,y:_};b=E.x,_=E.y;var A=c.hasOwnProperty("x"),S=c.hasOwnProperty("y"),w=d,x=o,C=window;if(f){var N=z(i),q="clientHeight",O="clientWidth";if(N===L(i)&&"static"!==I(N=P(i)).position&&"absolute"===h&&(q="scrollHeight",O="scrollWidth"),r===o||(r===d||r===l)&&s===p)x=a,_-=(g&&N===C&&C.visualViewport?C.visualViewport.height:N[q])-n.height,_*=u?1:-1;if(r===d||(r===o||r===a)&&s===p)w=l,b-=(g&&N===C&&C.visualViewport?C.visualViewport.width:N[O])-n.width,b*=u?1:-1}var D,B=Object.assign({position:h},f&&Y),j=!0===m?function(e,t){var i=e.x,n=e.y,r=t.devicePixelRatio||1;return{x:T(i*r)/r||0,y:T(n*r)/r||0}}({x:b,y:_},L(i)):{x:b,y:_};return b=j.x,_=j.y,u?Object.assign({},B,((D={})[x]=S?"0":"",D[w]=A?"0":"",D.transform=(C.devicePixelRatio||1)<=1?"translate("+b+"px, "+_+"px)":"translate3d("+b+"px, "+_+"px, 0)",D)):Object.assign({},B,((t={})[x]=S?_+"px":"",t[w]=A?b+"px":"",t.transform="",t))}var G={passive:!0};var K={left:"right",right:"left",bottom:"top",top:"bottom"};function Q(e){return e.replace(/left|right|bottom|top/g,(function(e){return K[e]}))}var ee={start:"end",end:"start"};function te(e){return e.replace(/start|end/g,(function(e){return ee[e]}))}function ie(e){var t=L(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function ne(e){return B(P(e)).left+ie(e).scrollLeft}function re(e){var t=I(e),i=t.overflow,n=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+r+n)}function se(e){return["html","body","#document"].indexOf(E(e))>=0?e.ownerDocument.body:S(e)&&re(e)?e:se(R(e))}function oe(e,t){var i;void 0===t&&(t=[]);var n=se(e),r=n===(null==(i=e.ownerDocument)?void 0:i.body),s=L(n),o=r?[s].concat(s.visualViewport||[],re(n)?n:[]):n,a=t.concat(o);return r?a:a.concat(oe(R(o)))}function ae(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function le(e,t,i){return t===m?ae(function(e,t){var i=L(e),n=P(e),r=i.visualViewport,s=n.clientWidth,o=n.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;var d=D();(d||!d&&"fixed"===t)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a+ne(e),y:l}}(e,i)):A(t)?function(e,t){var i=B(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(t,i):ae(function(e){var t,i=P(e),n=ie(e),r=null==(t=e.ownerDocument)?void 0:t.body,s=N(i.scrollWidth,i.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=N(i.scrollHeight,i.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-n.scrollLeft+ne(e),l=-n.scrollTop;return"rtl"===I(r||i).direction&&(a+=N(i.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(P(e)))}function de(e,t,i,n){var r="clippingParents"===t?function(e){var t=oe(R(e)),i=["absolute","fixed"].indexOf(I(e).position)>=0&&S(e)?z(e):e;return A(i)?t.filter((function(e){return A(e)&&k(e,i)&&"body"!==E(e)})):[]}(e):[].concat(t),s=[].concat(r,[i]),o=s[0],a=s.reduce((function(t,i){var r=le(e,i,n);return t.top=N(r.top,t.top),t.right=q(r.right,t.right),t.bottom=q(r.bottom,t.bottom),t.left=N(r.left,t.left),t}),le(e,o,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function ce(e){var t,i=e.reference,n=e.element,r=e.placement,s=r?C(r):null,c=r?X(r):null,h=i.x+i.width/2-n.width/2,f=i.y+i.height/2-n.height/2;switch(s){case o:t={x:h,y:i.y-n.height};break;case a:t={x:h,y:i.y+i.height};break;case l:t={x:i.x+i.width,y:f};break;case d:t={x:i.x-n.width,y:f};break;default:t={x:i.x,y:i.y}}var m=s?V(s):null;if(null!=m){var g="y"===m?"height":"width";switch(c){case u:t[m]=t[m]-(i[g]/2-n[g]/2);break;case p:t[m]=t[m]+(i[g]/2-n[g]/2)}}return t}function he(e,t){void 0===t&&(t={});var i=t,n=i.placement,r=void 0===n?e.placement:n,s=i.strategy,d=void 0===s?e.strategy:s,c=i.boundary,u=void 0===c?f:c,p=i.rootBoundary,b=void 0===p?m:p,y=i.elementContext,_=void 0===y?g:y,E=i.altBoundary,L=void 0!==E&&E,S=i.padding,w=void 0===S?0:S,x=F("number"!=typeof w?w:U(w,h)),C=_===g?v:g,N=e.rects.popper,q=e.elements[L?C:_],T=de(A(q)?q:q.contextElement||P(e.elements.popper),u,b,d),O=B(e.elements.reference),D=ce({reference:O,element:N,strategy:"absolute",placement:r}),j=ae(Object.assign({},N,D)),k=_===g?j:O,I={top:T.top-k.top+x.top,bottom:k.bottom-T.bottom+x.bottom,left:T.left-k.left+x.left,right:k.right-T.right+x.right},H=e.modifiersData.offset;if(_===g&&H){var R=H[r];Object.keys(I).forEach((function(e){var t=[l,a].indexOf(e)>=0?1:-1,i=[o,a].indexOf(e)>=0?"y":"x";I[e]+=R[i]*t}))}return I}function ue(e,t){void 0===t&&(t={});var i=t,n=i.placement,r=i.boundary,s=i.rootBoundary,o=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,d=void 0===l?y:l,c=X(n),u=c?a?b:b.filter((function(e){return X(e)===c})):h,p=u.filter((function(e){return d.indexOf(e)>=0}));0===p.length&&(p=u);var f=p.reduce((function(t,i){return t[i]=he(e,{placement:i,boundary:r,rootBoundary:s,padding:o})[C(i)],t}),{});return Object.keys(f).sort((function(e,t){return f[e]-f[t]}))}var pe={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var r=i.mainAxis,s=void 0===r||r,h=i.altAxis,p=void 0===h||h,f=i.fallbackPlacements,m=i.padding,g=i.boundary,v=i.rootBoundary,b=i.altBoundary,y=i.flipVariations,_=void 0===y||y,E=i.allowedAutoPlacements,L=t.options.placement,A=C(L),S=f||(A===L||!_?[Q(L)]:function(e){if(C(e)===c)return[];var t=Q(e);return[te(e),t,te(t)]}(L)),w=[L].concat(S).reduce((function(e,i){return e.concat(C(i)===c?ue(t,{placement:i,boundary:g,rootBoundary:v,padding:m,flipVariations:_,allowedAutoPlacements:E}):i)}),[]),x=t.rects.reference,N=t.rects.popper,q=new Map,T=!0,O=w[0],D=0;D<w.length;D++){var B=w[D],j=C(B),k=X(B)===u,I=[o,a].indexOf(j)>=0,H=I?"width":"height",P=he(t,{placement:B,boundary:g,rootBoundary:v,altBoundary:b,padding:m}),R=I?k?l:d:k?a:o;x[H]>N[H]&&(R=Q(R));var M=Q(R),$=[];if(s&&$.push(P[j]<=0),p&&$.push(P[R]<=0,P[M]<=0),$.every((function(e){return e}))){O=B,T=!1;break}q.set(B,$)}if(T)for(var z=function(e){var t=w.find((function(t){var i=q.get(t);if(i)return i.slice(0,e).every((function(e){return e}))}));if(t)return O=t,"break"},V=_?3:1;V>0;V--){if("break"===z(V))break}t.placement!==O&&(t.modifiersData[n]._skip=!0,t.placement=O,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function fe(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function me(e){return[o,l,a,d].some((function(t){return e[t]>=0}))}var ge={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,n=e.name,r=i.offset,s=void 0===r?[0,0]:r,a=y.reduce((function(e,i){return e[i]=function(e,t,i){var n=C(e),r=[d,o].indexOf(n)>=0?-1:1,s="function"==typeof i?i(Object.assign({},t,{placement:e})):i,a=s[0],c=s[1];return a=a||0,c=(c||0)*r,[d,l].indexOf(n)>=0?{x:c,y:a}:{x:a,y:c}}(i,t.rects,s),e}),{}),c=a[t.placement],h=c.x,u=c.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=h,t.modifiersData.popperOffsets.y+=u),t.modifiersData[n]=a}};var ve={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name,r=i.mainAxis,s=void 0===r||r,c=i.altAxis,h=void 0!==c&&c,p=i.boundary,f=i.rootBoundary,m=i.altBoundary,g=i.padding,v=i.tether,b=void 0===v||v,y=i.tetherOffset,_=void 0===y?0:y,E=he(t,{boundary:p,rootBoundary:f,padding:g,altBoundary:m}),L=C(t.placement),A=X(t.placement),S=!A,w=V(L),x="x"===w?"y":"x",T=t.modifiersData.popperOffsets,O=t.rects.reference,D=t.rects.popper,B="function"==typeof _?_(Object.assign({},t.rects,{placement:t.placement})):_,k="number"==typeof B?{mainAxis:B,altAxis:B}:Object.assign({mainAxis:0,altAxis:0},B),I=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,H={x:0,y:0};if(T){if(s){var P,R="y"===w?o:d,M="y"===w?a:l,$="y"===w?"height":"width",F=T[w],U=F+E[R],J=F-E[M],Y=b?-D[$]/2:0,Z=A===u?O[$]:D[$],G=A===u?-D[$]:-O[$],K=t.elements.arrow,Q=b&&K?j(K):{width:0,height:0},ee=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},te=ee[R],ie=ee[M],ne=W(0,O[$],Q[$]),re=S?O[$]/2-Y-ne-te-k.mainAxis:Z-ne-te-k.mainAxis,se=S?-O[$]/2+Y+ne+ie+k.mainAxis:G+ne+ie+k.mainAxis,oe=t.elements.arrow&&z(t.elements.arrow),ae=oe?"y"===w?oe.clientTop||0:oe.clientLeft||0:0,le=null!=(P=null==I?void 0:I[w])?P:0,de=F+se-le,ce=W(b?q(U,F+re-le-ae):U,F,b?N(J,de):J);T[w]=ce,H[w]=ce-F}if(h){var ue,pe="x"===w?o:d,fe="x"===w?a:l,me=T[x],ge="y"===x?"height":"width",ve=me+E[pe],be=me-E[fe],ye=-1!==[o,d].indexOf(L),_e=null!=(ue=null==I?void 0:I[x])?ue:0,Ee=ye?ve:me-O[ge]-D[ge]-_e+k.altAxis,Le=ye?me+O[ge]+D[ge]-_e-k.altAxis:be,Ae=b&&ye?function(e,t,i){var n=W(e,t,i);return n>i?i:n}(Ee,me,Le):W(b?Ee:ve,me,b?Le:be);T[x]=Ae,H[x]=Ae-me}t.modifiersData[n]=H}},requiresIfExists:["offset"]};function be(e,t,i){void 0===i&&(i=!1);var n,r,s=S(t),o=S(t)&&function(e){var t=e.getBoundingClientRect(),i=T(t.width)/e.offsetWidth||1,n=T(t.height)/e.offsetHeight||1;return 1!==i||1!==n}(t),a=P(t),l=B(e,o,i),d={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(s||!s&&!i)&&(("body"!==E(t)||re(a))&&(d=(n=t)!==L(n)&&S(n)?{scrollLeft:(r=n).scrollLeft,scrollTop:r.scrollTop}:ie(n)),S(t)?((c=B(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):a&&(c.x=ne(a))),{x:l.left+d.scrollLeft-c.x,y:l.top+d.scrollTop-c.y,width:l.width,height:l.height}}function ye(e){var t=new Map,i=new Set,n=[];function r(e){i.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!i.has(e)){var n=t.get(e);n&&r(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){i.has(e.name)||r(e)})),n}var _e={placement:"bottom",modifiers:[],strategy:"absolute"};function Ee(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Le(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,n=void 0===i?[]:i,r=t.defaultOptions,s=void 0===r?_e:r;return function(e,t,i){void 0===i&&(i=s);var r,o,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},_e,s),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],d=!1,c={state:a,setOptions:function(i){var r="function"==typeof i?i(a.options):i;h(),a.options=Object.assign({},s,a.options,r),a.scrollParents={reference:A(e)?oe(e):e.contextElement?oe(e.contextElement):[],popper:oe(t)};var o,d,u=function(e){var t=ye(e);return _.reduce((function(e,i){return e.concat(t.filter((function(e){return e.phase===i})))}),[])}((o=[].concat(n,a.options.modifiers),d=o.reduce((function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e}),{}),Object.keys(d).map((function(e){return d[e]}))));return a.orderedModifiers=u.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,i=e.options,n=void 0===i?{}:i,r=e.effect;if("function"==typeof r){var s=r({state:a,name:t,instance:c,options:n}),o=function(){};l.push(s||o)}})),c.update()},forceUpdate:function(){if(!d){var e=a.elements,t=e.reference,i=e.popper;if(Ee(t,i)){a.rects={reference:be(t,z(i),"fixed"===a.options.strategy),popper:j(i)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<a.orderedModifiers.length;n++)if(!0!==a.reset){var r=a.orderedModifiers[n],s=r.fn,o=r.options,l=void 0===o?{}:o,h=r.name;"function"==typeof s&&(a=s({state:a,options:l,name:h,instance:c})||a)}else a.reset=!1,n=-1}}},update:(r=function(){return new Promise((function(e){c.forceUpdate(),e(a)}))},function(){return o||(o=new Promise((function(e){Promise.resolve().then((function(){o=void 0,e(r())}))}))),o}),destroy:function(){h(),d=!0}};if(!Ee(e,t))return c;function h(){l.forEach((function(e){return e()})),l=[]}return c.setOptions(i).then((function(e){!d&&i.onFirstUpdate&&i.onFirstUpdate(e)})),c}}var Ae=Le({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,n=e.options,r=n.scroll,s=void 0===r||r,o=n.resize,a=void 0===o||o,l=L(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&d.forEach((function(e){e.addEventListener("scroll",i.update,G)})),a&&l.addEventListener("resize",i.update,G),function(){s&&d.forEach((function(e){e.removeEventListener("scroll",i.update,G)})),a&&l.removeEventListener("resize",i.update,G)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=ce({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,n=i.gpuAcceleration,r=void 0===n||n,s=i.adaptive,o=void 0===s||s,a=i.roundOffsets,l=void 0===a||a,d={placement:C(t.placement),variation:X(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Z(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Z(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},x,ge,pe,ve,J,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,n=t.rects.reference,r=t.rects.popper,s=t.modifiersData.preventOverflow,o=he(t,{elementContext:"reference"}),a=he(t,{altBoundary:!0}),l=fe(o,n),d=fe(a,r,s),c=me(l),h=me(d);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:c,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":h})}}]});const Se=()=>window.innerWidth<=450,we=()=>window.innerWidth<=768,xe=["name","title","imageSrc","bio","variant","acting","department"],Ce=[...xe,"responsive","direction","verticalDepth","depth","popperDialog"];class Ne{constructor(e){var i;this.nodeIdNum=0,this.dataByNodeId={},this.isMobileOrTablet=we(),this.containerId=`${t}__${Ne.idNum++}`,e.id=this.containerId,e?(null===(i=e.querySelectorAll("li, ul"))||void 0===i||i.forEach((e=>{e.id=this.generateNodeId()})),this.container=e,this.init()):console.error("OrgChart -> Can't initialize orgchart. Container not found.","Container id: ",this.containerId)}generateNodeId(){return`${this.containerId}__node__${this.nodeIdNum++}`}createNode(t,i){var n;if(null==i?void 0:i.imageSrc){const n=globalThis.document.createElement("div");n.classList.add(`${e}-avatar--container`);const r=globalThis.document.createElement("div");r.classList.add(`${e}-avatar--sub-container`);const s=globalThis.document.createElement("img");s.srcset=i.imageSrc,r.appendChild(s),n.appendChild(r),t.prepend(n),t.classList.add(`${e}__node--with-image`)}if(null==i?void 0:i.dataRefId){const e=this.dataByNodeId[i.dataRefId];t.setAttribute("data-dataRefId",i.dataRefId),this.addFancyBoxDialog(t,e),this.addAriaLabels(t,e)}if("true"===(null==i?void 0:i.acting)){const e=t.querySelector(".content");e&&e.innerText&&(e.innerText=`Acting ${e.innerText}`)}if(null==i?void 0:i.department){if(t.querySelector(".content")){const e=globalThis.document.createElement("div");e.classList.add("department"),e.innerText=i.department,t.appendChild(e),t.classList.add("with-department")}}t.classList.add(`variant-${null!==(n=null==i?void 0:i.variant)&&void 0!==n?n:1}`)}init(){if(!this.container&&!this.data)return console.error("OrgChart -> Container or data not found","Container id: ",this.containerId);this.data=this.extractDataFromContainer(this.container),this.dataSerialized=JSON.stringify(this.data);const e=this.createNode.bind(this);this.buildChart(e),"true"===this.data.responsive&&globalThis.addEventListener("resize",(()=>{const t=we();this.isMobileOrTablet!==t&&(this.isMobileOrTablet=t,this.destroyChart(),this.buildChart(e))}))}buildChart(e){if(this.data){const t={chartContainer:`#${this.containerId}`,data:this.data,nodeContent:"title",createNode:e,toggleSiblingsResp:!1,parentNodeSymbol:"fa-sitemap"};this.data.depth&&(t.depth=this.data.depth),this.data.verticalDepth&&(t.verticalDepth=this.data.verticalDepth),"true"===this.data.responsive&&this.isMobileOrTablet&&(t.verticalDepth=2),this.orgChartInstance=new s(t)}}destroyChart(){var e,t,i;null===(i=null===(t=null===(e=this.container)||void 0===e?void 0:e.querySelector(".orgchart"))||void 0===t?void 0:t.remove)||void 0===i||i.call(t),this.orgChartInstance=null,this.dataByNodeId={},this.data=JSON.parse(this.dataSerialized)}closeAllBioDialogs(){this.container.querySelectorAll(this.popperShowSelector()).forEach((e=>{var t;(null===(t=null==e?void 0:e.classList)||void 0===t?void 0:t.remove)&&e.classList.remove(this.popperShowSelector(!0))}))}popperMainSelector(e=!1){return`${e?"":"."}${t}__bio-dialog`}popperShowSelector(e=!1){return`${e?"":"."}${t}__show-bio`}addFancyBoxDialog(e,i){if(null==i?void 0:i.bio){e.classList.add("with-bio","fancybox-dialog");const r=(n=i.bio,function(e){var i,r,s,o,a,l;let d=[];const c=(e=>{var t;if("string"!=typeof e&&!e)return null;const i=e.match(/(?:^<p>|^&lt;p&gt;)\s*((?:https?:\/\/)?(?:www\.)?[a-zA-Z0-9-.]+\.[a-zA-Z]{2,}(?:\/[^\s<]*)?)(?=\s*<\/p>|&gt;)/);return null!==(t=null==i?void 0:i[1])&&void 0!==t?t:null})(n);if(d=c?$.parseHTML(`<div style="display: contents"><div class='${t}__fancybox--content has-iframe'><iframe src="${c}"</div></div>`):$.parseHTML(`<div style="display: contents"><div class='${t}__fancybox--content'>${n}</div></div>`),e.stopPropagation(),(null===(s=null===(r=null===(i=e.target)||void 0===i?void 0:i.classList)||void 0===r?void 0:r.contains)||void 0===s?void 0:s.call(r,"edge"))||(null===(l=null===(a=null===(o=e.target)||void 0===o?void 0:o.classList)||void 0===a?void 0:a.contains)||void 0===l?void 0:l.call(a,"toggleBtn")))return;const h={padding:Se()?[25,0,25,0]:25,closeBtn:!0,afterLoad:function(){var e;const i=null===(e=null==this?void 0:this.locked)||void 0===e?void 0:e[0];if(i){i.classList.add(`${t}__fancybox--backdrop`);const e=i.querySelector(".fancybox-wrap"),n=i.querySelector(".fancybox-skin");Se()&&(i.classList.add("isMobile"),e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.inset="0");const r=document.createElement("div");r.classList.add("bio-dialog-header");const s=document.createElement("span");s.innerText="Biography",r.appendChild(s),r.setAttribute("aria-label","Biography"),r.setAttribute("title","Biography"),r.setAttribute("role","heading"),n.appendChild(r);const o=globalThis.document.createElement("i"),a=globalThis.document.createElement("button");o.classList.add("fa","fa-times"),a.classList.add("close-bio"),a.appendChild(o),a.setAttribute("aria-label","Close biography dialog"),a.setAttribute("title","Close biography dialog"),a.setAttribute("type","button"),a.addEventListener("click",(function(e){var t;e.stopPropagation();const i=document.body.querySelector(".fancybox-close");null===(t=null==i?void 0:i.click)||void 0===t||t.call(i)})),n.appendChild(a)}}};$.fancybox.open(d,h)});e.addEventListener("click",r)}var n}addPopperBioDialog(e,t){if(t.bio){e.classList.add("with-bio","popper-dialog");const n=globalThis.document.createElement("div");n.classList.add(`${this.popperMainSelector(!0)}`,`bio-dialog-${t.dataRefId}`);const r=globalThis.document.createElement("span");r.classList.add("bio-dialog--text");const s=i(t.bio);if(null==s?void 0:s.length){Array.from(s).forEach((e=>{r.appendChild(e)}))}n.appendChild(r);const o=globalThis.document.createElement("div");o.classList.add("popper--arrow"),o.setAttribute("data-popper-arrow",""),n.appendChild(o);const a=globalThis.document.createElement("i");a.classList.add("fa","fa-times","close-bio");const l=this.popperShowSelector(),d=this.popperShowSelector(!0);a.addEventListener("click",(function(e){var t;e.stopPropagation(),null===(t=this.closest(l))||void 0===t||t.classList.remove(d)})),n.appendChild(a),e.appendChild(n),t.popperInstance=Ae(e,n,{strategy:"fixed",modifiers:[{name:"offset",options:{offset:[0,6]}}]});const c=this.closeAllBioDialogs.bind(this);e.addEventListener("click",(function(i){var n,r,s,o,a,l,h;i.stopPropagation(),(null===(s=null===(r=null===(n=i.target)||void 0===n?void 0:n.classList)||void 0===r?void 0:r.contains)||void 0===s?void 0:s.call(r,"edge"))||(null===(l=null===(a=null===(o=i.target)||void 0===o?void 0:o.classList)||void 0===a?void 0:a.contains)||void 0===l?void 0:l.call(a,"toggleBtn"))||e.classList.contains(d)||(c(),null===(h=t.popperInstance)||void 0===h||h.update(),e.classList.toggle(d))}))}}addAriaLabels(e,t){(null==t?void 0:t.name)&&(null==e||e.setAttribute("aria-labelledby",`[data-dataRefId="${t.dataRefId}"] .title`)),(null==t?void 0:t.title)&&(null==e||e.setAttribute("aria-describedby",`[data-dataRefId="${t.dataRefId}"] .content`))}getDataFromChildNode(e){const t=n(e);let i=null;xe.forEach((e=>{var n;if(null!==(n=t(e))&&void 0!==n&&n){const n=t(e);null!=n&&n&&(i?i[e]=n:i={[e]:n})}}));const r=e.id;return r&&i&&(i.dataRefId=r,this.dataByNodeId[r]=i),i}getDataFromParentNode(e){const t=n(e);let i=null;Ce.forEach((e=>{var n;if(null!==(n=t(e))&&void 0!==n&&n){let n=t(e);if("depth"===e||"verticalDepth"===e){const e=parseInt(n,10);"number"==typeof e&&e==e&&(n=e)}null!=n&&n&&(i?i[e]=n:i={[e]:n})}}));const r=e.id;return r&&i&&(i.dataRefId=r,this.dataByNodeId[r]=i),i&&(i.mainNode=!0),i}extractDataFromContainer(e,t=!1){var i;try{if(t){if(e){const t=this.getDataFromChildNode(e);if(t){const i=e.querySelector("ul");if(i){const e=i.querySelectorAll(`#${i.id}>li`);e.length>0&&(t.children=Array.from(e).map((e=>this.extractDataFromContainer(e,!0))))}return t}}}else{const t="li"==(null===(i=null==e?void 0:e.tagName)||void 0===i?void 0:i.toLowerCase())?e:null==e?void 0:e.querySelector("li");if(t){const e=this.getDataFromParentNode(t);if(e){const i=t.querySelector("ul");if(i){const t=i.querySelectorAll(`#${i.id}>li`);t.length>0&&(e.children=Array.from(t).map((e=>this.extractDataFromContainer(e,!0))))}return e}}}}catch(e){console.error("Can't extract data from container",{containerId:this.containerId})}return null}}Ne.idNum=1;new class{constructor(){this.chartInstances=[],this.init()}init(){try{this.containers=globalThis.document.querySelectorAll(`.${t}`),this.buildCharts()}catch(e){return void console.error("Can't build template. Err: ",e)}}buildCharts(){this.containers&&0!==this.containers.length?this.containers.forEach((e=>{this.chartInstances.push(new Ne(e))})):console.error("OrgChart -> No containers found")}};
